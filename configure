#!/bin/sh
# configure script for seqNdisplayR
# Detect libBigWig installation and create src/Makevars

echo "Configuring libBigWig linkage..."

# Search in common locations
for prefix in "/opt/homebrew" "/usr/local" "/usr"; do
  if [ -f "${prefix}/include/bigWig.h" ] && \
     [ -f "${prefix}/lib/libBigWig.a" -o -f "${prefix}/lib/libBigWig.dylib" -o -f "${prefix}/lib/libBigWig.so" ]; then
    found="$prefix"
    break
  fi
done

if [ -z "$found" ]; then
  cat <<EOF
ERROR: libBigWig not found.
Please install it first:
  macOS (Homebrew): brew install libbigwig
  Ubuntu/Debian:    sudo apt install libbigwig-dev
Then re-run installation.
EOF
  exit 1
fi

echo "Found libBigWig in: $found"

cat > src/Makevars <<EOF
PKG_CPPFLAGS = -I${found}/include
PKG_LIBS = -L/usr/local/lib -lBigWig
CXX_STD = CXX11
EOF

exit 0
